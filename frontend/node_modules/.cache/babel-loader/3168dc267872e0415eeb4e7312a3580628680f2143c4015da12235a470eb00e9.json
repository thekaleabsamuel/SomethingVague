{"ast":null,"code":"var _jsxFileName = \"/Users/new/Downloads/Projects/online-radio-station/src/context/AudioContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useState, useContext, useRef, useEffect } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AudioContext = /*#__PURE__*/createContext();\nexport const AudioProvider = ({\n  children\n}) => {\n  _s();\n  const [playlist, setPlaylist] = useState([]);\n  const [currentTrackIndex, setCurrentTrackIndex] = useState(0);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [progress, setProgress] = useState(0);\n  const [duration, setDuration] = useState(0);\n  const [error, setError] = useState(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const audioRef = useRef(null);\n\n  // Initialize audio element\n  useEffect(() => {\n    if (!audioRef.current) {\n      audioRef.current = new Audio();\n      audioRef.current.crossOrigin = 'anonymous';\n    }\n\n    // Set up audio event listeners\n    audioRef.current.onloadedmetadata = () => {\n      setDuration(audioRef.current.duration);\n    };\n    audioRef.current.ontimeupdate = () => {\n      setProgress(audioRef.current.currentTime);\n    };\n    audioRef.current.onended = () => {\n      handleNextTrack();\n    };\n\n    // Cleanup\n    return () => {\n      if (audioRef.current) {\n        audioRef.current.pause();\n        audioRef.current = null;\n      }\n    };\n  }, []);\n\n  // Fetch playlist\n  useEffect(() => {\n    const fetchPlaylist = async () => {\n      try {\n        const response = await fetch('http://localhost:5001/api/radio/tracks');\n        if (!response.ok) throw new Error('Failed to fetch tracks');\n        const data = await response.json();\n        setPlaylist(data);\n        setIsLoading(false);\n      } catch (err) {\n        console.error('Error fetching playlist:', err);\n        setError('Failed to load playlist');\n        setIsLoading(false);\n      }\n    };\n    fetchPlaylist();\n  }, []);\n\n  // Handle track changes\n  useEffect(() => {\n    if (playlist.length > 0 && currentTrackIndex >= 0) {\n      const currentTrack = playlist[currentTrackIndex];\n      if (!currentTrack) return;\n      const loadTrack = async () => {\n        try {\n          setIsLoading(true);\n          setError(null);\n          const audioUrl = getAbsolutePath(currentTrack.url);\n          audioRef.current.src = audioUrl;\n          if (isPlaying) {\n            audioRef.current.play();\n          }\n          setIsLoading(false);\n        } catch (err) {\n          console.error('Error loading track:', err);\n          setError('Error loading track');\n          setIsLoading(false);\n        }\n      };\n      loadTrack();\n    }\n  }, [currentTrackIndex, playlist]);\n  const handlePlayPause = () => {\n    if (isPlaying) {\n      audioRef.current.pause();\n    } else {\n      audioRef.current.play();\n    }\n    setIsPlaying(!isPlaying);\n  };\n  const handleNextTrack = () => {\n    setCurrentTrackIndex(prevIndex => (prevIndex + 1) % playlist.length);\n  };\n  const handlePreviousTrack = () => {\n    setCurrentTrackIndex(prevIndex => prevIndex === 0 ? playlist.length - 1 : prevIndex - 1);\n  };\n  const getAbsolutePath = relativePath => {\n    return new URL(relativePath, window.location.origin).href;\n  };\n  const value = {\n    playlist,\n    currentTrackIndex,\n    isPlaying,\n    progress,\n    duration,\n    error,\n    isLoading,\n    currentTrack: playlist[currentTrackIndex],\n    handlePlayPause,\n    handleNextTrack,\n    handlePreviousTrack,\n    audioRef\n  };\n  return /*#__PURE__*/_jsxDEV(AudioContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 133,\n    columnNumber: 5\n  }, this);\n};\n_s(AudioProvider, \"xm5nesHwQ6G23EaebM0mkzty8pA=\");\n_c = AudioProvider;\nexport const useAudio = () => {\n  _s2();\n  const context = useContext(AudioContext);\n  if (!context) {\n    throw new Error('useAudio must be used within an AudioProvider');\n  }\n  return context;\n};\n_s2(useAudio, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport default AudioContext;\nvar _c;\n$RefreshReg$(_c, \"AudioProvider\");","map":{"version":3,"names":["React","createContext","useState","useContext","useRef","useEffect","jsxDEV","_jsxDEV","AudioContext","AudioProvider","children","_s","playlist","setPlaylist","currentTrackIndex","setCurrentTrackIndex","isPlaying","setIsPlaying","progress","setProgress","duration","setDuration","error","setError","isLoading","setIsLoading","audioRef","current","Audio","crossOrigin","onloadedmetadata","ontimeupdate","currentTime","onended","handleNextTrack","pause","fetchPlaylist","response","fetch","ok","Error","data","json","err","console","length","currentTrack","loadTrack","audioUrl","getAbsolutePath","url","src","play","handlePlayPause","prevIndex","handlePreviousTrack","relativePath","URL","window","location","origin","href","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","useAudio","_s2","context","$RefreshReg$"],"sources":["/Users/new/Downloads/Projects/online-radio-station/src/context/AudioContext.js"],"sourcesContent":["import React, { createContext, useState, useContext, useRef, useEffect } from 'react';\n\nconst AudioContext = createContext();\n\nexport const AudioProvider = ({ children }) => {\n  const [playlist, setPlaylist] = useState([]);\n  const [currentTrackIndex, setCurrentTrackIndex] = useState(0);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [progress, setProgress] = useState(0);\n  const [duration, setDuration] = useState(0);\n  const [error, setError] = useState(null);\n  const [isLoading, setIsLoading] = useState(true);\n\n  const audioRef = useRef(null);\n\n  // Initialize audio element\n  useEffect(() => {\n    if (!audioRef.current) {\n      audioRef.current = new Audio();\n      audioRef.current.crossOrigin = 'anonymous';\n    }\n\n    // Set up audio event listeners\n    audioRef.current.onloadedmetadata = () => {\n      setDuration(audioRef.current.duration);\n    };\n\n    audioRef.current.ontimeupdate = () => {\n      setProgress(audioRef.current.currentTime);\n    };\n\n    audioRef.current.onended = () => {\n      handleNextTrack();\n    };\n\n    // Cleanup\n    return () => {\n      if (audioRef.current) {\n        audioRef.current.pause();\n        audioRef.current = null;\n      }\n    };\n  }, []);\n\n  // Fetch playlist\n  useEffect(() => {\n    const fetchPlaylist = async () => {\n      try {\n        const response = await fetch('http://localhost:5001/api/radio/tracks');\n        if (!response.ok) throw new Error('Failed to fetch tracks');\n        const data = await response.json();\n        setPlaylist(data);\n        setIsLoading(false);\n      } catch (err) {\n        console.error('Error fetching playlist:', err);\n        setError('Failed to load playlist');\n        setIsLoading(false);\n      }\n    };\n\n    fetchPlaylist();\n  }, []);\n\n  // Handle track changes\n  useEffect(() => {\n    if (playlist.length > 0 && currentTrackIndex >= 0) {\n      const currentTrack = playlist[currentTrackIndex];\n      if (!currentTrack) return;\n\n      const loadTrack = async () => {\n        try {\n          setIsLoading(true);\n          setError(null);\n\n          const audioUrl = getAbsolutePath(currentTrack.url);\n          audioRef.current.src = audioUrl;\n\n          if (isPlaying) {\n            audioRef.current.play();\n          }\n\n          setIsLoading(false);\n        } catch (err) {\n          console.error('Error loading track:', err);\n          setError('Error loading track');\n          setIsLoading(false);\n        }\n      };\n\n      loadTrack();\n    }\n  }, [currentTrackIndex, playlist]);\n\n  const handlePlayPause = () => {\n    if (isPlaying) {\n      audioRef.current.pause();\n    } else {\n      audioRef.current.play();\n    }\n    setIsPlaying(!isPlaying);\n  };\n\n  const handleNextTrack = () => {\n    setCurrentTrackIndex((prevIndex) => (prevIndex + 1) % playlist.length);\n  };\n\n  const handlePreviousTrack = () => {\n    setCurrentTrackIndex((prevIndex) => \n      prevIndex === 0 ? playlist.length - 1 : prevIndex - 1\n    );\n  };\n\n  const getAbsolutePath = (relativePath) => {\n    return new URL(relativePath, window.location.origin).href;\n  };\n\n  const value = {\n    playlist,\n    currentTrackIndex,\n    isPlaying,\n    progress,\n    duration,\n    error,\n    isLoading,\n    currentTrack: playlist[currentTrackIndex],\n    handlePlayPause,\n    handleNextTrack,\n    handlePreviousTrack,\n    audioRef\n  };\n\n  return (\n    <AudioContext.Provider value={value}>\n      {children}\n    </AudioContext.Provider>\n  );\n};\n\nexport const useAudio = () => {\n  const context = useContext(AudioContext);\n  if (!context) {\n    throw new Error('useAudio must be used within an AudioProvider');\n  }\n  return context;\n};\n\nexport default AudioContext; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}